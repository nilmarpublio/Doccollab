{% extends "base.html" %}

{% block title %}{{ _('PDF Viewer') }} - {{ project.name }}{% endblock %}

{% block extra_css %}
<style>
.pdf-viewer-container {
    display: flex;
    height: calc(100vh - 80px);
    margin: 0 20px;
    padding: 0;
}

.pdf-sidebar {
    width: 300px;
    background: #f8f9fa;
    border-right: 1px solid #dee2e6;
    padding: 20px;
    overflow-y: auto;
}

.pdf-main {
    flex: 1;
    display: flex;
    flex-direction: column;
}

.pdf-toolbar {
    background: #fff;
    border-bottom: 1px solid #dee2e6;
    padding: 15px 20px;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.pdf-title {
    font-size: 18px;
    font-weight: 600;
    color: #333;
    margin: 0;
}

.pdf-actions {
    display: flex;
    gap: 10px;
    align-items: center;
}

.pdf-content {
    flex: 1;
    background: #f5f5f5;
    padding: 20px;
    overflow-y: auto;
}

.pdf-viewer {
    background: #fff;
    border-radius: 8px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    margin: 0 auto;
    max-width: 800px;
    min-height: 600px;
    position: relative;
    overflow: hidden;
}

.pdf-page {
    padding: 40px;
    font-family: 'Times New Roman', serif;
    font-size: 12pt;
    line-height: 1.6;
    color: #000;
    background: #fff;
    min-height: 600px;
}

.pdf-header {
    text-align: center;
    margin-bottom: 30px;
    padding-bottom: 20px;
    border-bottom: 2px solid #333;
}

.pdf-title-doc {
    font-size: 18pt;
    font-weight: bold;
    margin-bottom: 10px;
}

.pdf-subtitle {
    font-size: 14pt;
    color: #666;
}

.pdf-section {
    margin-bottom: 25px;
}

.pdf-section h1 {
    font-size: 16pt;
    font-weight: bold;
    margin-bottom: 15px;
    color: #333;
}

.pdf-section h2 {
    font-size: 14pt;
    font-weight: bold;
    margin-bottom: 10px;
    color: #333;
}

.pdf-section p {
    margin-bottom: 12px;
    text-align: justify;
}

.pdf-math {
    background: #f8f9fa;
    padding: 15px;
    border-radius: 4px;
    margin: 15px 0;
    text-align: center;
    font-family: 'Courier New', monospace;
    font-size: 11pt;
}

.pdf-footer {
    position: absolute;
    bottom: 20px;
    right: 20px;
    font-size: 10pt;
    color: #666;
}

.btn {
    display: inline-block;
    padding: 10px 20px;
    border: none;
    border-radius: 6px;
    text-decoration: none;
    cursor: pointer;
    font-size: 14px;
    font-weight: 500;
    transition: all 0.2s;
    text-align: center;
}

.btn-primary {
    background: #007bff;
    color: white;
}

.btn-primary:hover {
    background: #0056b3;
}

.btn-secondary {
    background: #6c757d;
    color: white;
}

.btn-secondary:hover {
    background: #545b62;
}

.btn-success {
    background: #28a745;
    color: white;
}

.btn-success:hover {
    background: #1e7e34;
}

.sidebar-section {
    background: #fff;
    border-radius: 8px;
    padding: 15px;
    margin-bottom: 20px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.sidebar-section h4 {
    margin: 0 0 15px 0;
    color: #333;
    font-size: 16px;
}

.project-info h3 {
    margin: 0 0 10px 0;
    color: #333;
    font-size: 18px;
}

.project-info p {
    margin: 0;
    color: #666;
    font-size: 14px;
}

.pdf-controls {
    display: flex;
    gap: 10px;
    margin-bottom: 20px;
}

.pdf-controls input {
    flex: 1;
    padding: 8px 12px;
    border: 1px solid #dee2e6;
    border-radius: 4px;
    font-size: 14px;
}

.pdf-controls button {
    padding: 8px 16px;
    font-size: 14px;
}

@media (max-width: 768px) {
    .pdf-viewer-container {
        flex-direction: column;
        height: auto;
        margin: 0 10px;
    }
    
    .pdf-sidebar {
        width: 100%;
        height: auto;
    }
    
    .pdf-actions {
        flex-direction: column;
        gap: 5px;
    }
}
</style>
{% endblock %}

{% block content %}
<div class="pdf-viewer-container">
    <!-- Sidebar -->
    <div class="pdf-sidebar">
        <div class="sidebar-section project-info">
            <h3>{{ project.name }}</h3>
            <p>{{ project.description or _('No description') }}</p>
        </div>
        
        <div class="sidebar-section">
            <h4>{{ _('PDF Controls') }}</h4>
            <div class="pdf-controls">
                <input type="number" id="pageNumber" value="1" min="1" max="10">
                <button class="btn btn-primary" onclick="goToPage()">
                    {{ _('Go to Page') }}
                </button>
            </div>
            <button class="btn btn-success" onclick="downloadPDF()">
                <i class="fas fa-download"></i> {{ _('Download PDF') }}
            </button>
        </div>
        
        <div class="sidebar-section">
            <h4>{{ _('Navigation') }}</h4>
            <a href="{{ url_for('editor', project_id=project.id) }}" class="btn btn-secondary">
                <i class="fas fa-edit"></i> {{ _('Back to Editor') }}
            </a>
            <a href="{{ url_for('dashboard') }}" class="btn btn-secondary">
                <i class="fas fa-arrow-left"></i> {{ _('Back to Projects') }}
            </a>
        </div>
    </div>
    
    <!-- Main PDF Viewer Area -->
    <div class="pdf-main">
        <div class="pdf-toolbar">
            <h1 class="pdf-title">{{ _('PDF Viewer') }} - {{ project.name }}</h1>
            <div class="pdf-actions">
                <button class="btn btn-primary" onclick="refreshPDF()">
                    <i class="fas fa-sync"></i> {{ _('Refresh') }}
                </button>
                <button class="btn btn-success" onclick="downloadPDF()">
                    <i class="fas fa-download"></i> {{ _('Download') }}
                </button>
            </div>
        </div>
        
        <div class="pdf-content">
            <div class="pdf-viewer">
                <div class="pdf-page">
                    <div class="pdf-header">
                        <div class="pdf-title-doc">{{ project.name }}</div>
                        <div class="pdf-subtitle">{{ _('LaTeX Document') }}</div>
                    </div>
                    
                    <div class="pdf-section">
                        <h1>{{ _('Introduction') }}</h1>
                        <p>{{ _('This is a preview of your LaTeX document. The actual PDF would contain the formatted content from your LaTeX source code.') }}</p>
                        <p>{{ _('You can see how your document structure, formatting, and content would appear in the final PDF output.') }}</p>
                    </div>
                    
                    <div class="pdf-section">
                        <h2>{{ _('Document Structure') }}</h2>
                        <p>{{ _('Your LaTeX document follows a structured format with:') }}</p>
                        <ul>
                            <li>{{ _('Document class declaration') }}</li>
                            <li>{{ _('Package imports') }}</li>
                            <li>{{ _('Document content') }}</li>
                            <li>{{ _('Proper closing tags') }}</li>
                        </ul>
                    </div>
                    
                    <div class="pdf-section">
                        <h2>{{ _('Mathematical Content') }}</h2>
                        <p>{{ _('Mathematical equations and formulas would be rendered here:') }}</p>
                        <div class="pdf-math">
                            E = mcÂ²
                        </div>
                        <div class="pdf-math">
                            $$\int_{-\infty}^{\infty} e^{-x^2} dx = \sqrt{\pi}$$
                        </div>
                    </div>
                    
                    <div class="pdf-section">
                        <h2>{{ _('Conclusion') }}</h2>
                        <p>{{ _('This preview shows how your LaTeX document would look when compiled to PDF. The actual compilation process would generate a proper PDF file with all the formatting and content from your source.') }}</p>
                    </div>
                    
                    <div class="pdf-footer">
                        Page 1 of 1
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
function goToPage() {
    const pageNumber = document.getElementById('pageNumber').value;
    showNotification(`{{ _("Going to page") }} ${pageNumber}`, 'info');
}

function refreshPDF() {
    showNotification('{{ _("PDF refreshed!") }}', 'success');
    // Simular refresh
    const viewer = document.querySelector('.pdf-viewer');
    viewer.style.opacity = '0.7';
    setTimeout(() => {
        viewer.style.opacity = '1';
    }, 500);
}

function downloadPDF() {
    showNotification('{{ _("PDF download started! (Simulated)") }}', 'info');
}

function showNotification(message, type) {
    const notification = document.createElement('div');
    notification.style.cssText = `
        position: fixed;
        top: 20px;
        right: 20px;
        padding: 15px 20px;
        background: ${type === 'success' ? '#28a745' : type === 'error' ? '#dc3545' : '#007bff'};
        color: white;
        border-radius: 4px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        z-index: 10000;
        font-size: 14px;
    `;
    notification.textContent = message;
    document.body.appendChild(notification);
    
    setTimeout(() => {
        notification.remove();
    }, 3000);
}

// Atalhos de teclado
document.addEventListener('keydown', function(e) {
    if (e.ctrlKey) {
        switch(e.key) {
            case 's':
                e.preventDefault();
                downloadPDF();
                break;
            case 'r':
                e.preventDefault();
                refreshPDF();
                break;
        }
    }
});
</script>
{% endblock %}