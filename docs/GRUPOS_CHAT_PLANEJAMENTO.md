# üìã Planejamento: Grupos de Chat/Colabora√ß√£o

> **Data**: 11/10/2025  
> **Objetivo**: Implementar sistema completo de grupos de colabora√ß√£o com chat em tempo real

---

## üéØ VIS√ÉO GERAL

Adicionar ao DocCollab um sistema de **grupos de colabora√ß√£o** onde:
- Usu√°rios podem criar grupos
- Adicionar/remover membros
- Compartilhar documentos LaTeX
- Chat em tempo real espec√≠fico do grupo
- Permiss√µes granulares (admin, membro, visualizador)

---

## üìä ARQUITETURA

### **Novos Modelos (SQLAlchemy)**

```python
# models/group.py
class Group(db.Model):
    id = db.Column(db.Integer, primary_key=True)
    name = db.Column(db.String(100), nullable=False)
    description = db.Column(db.Text)
    created_at = db.Column(db.DateTime, default=datetime.utcnow)
    created_by = db.Column(db.Integer, db.ForeignKey('user.id'))
    
    # Relacionamentos
    members = db.relationship('GroupMember', backref='group', lazy=True)
    documents = db.relationship('GroupDocument', backref='group', lazy=True)
    messages = db.relationship('GroupMessage', backref='group', lazy=True)

# models/group_member.py
class GroupMember(db.Model):
    id = db.Column(db.Integer, primary_key=True)
    group_id = db.Column(db.Integer, db.ForeignKey('group.id'))
    user_id = db.Column(db.Integer, db.ForeignKey('user.id'))
    role = db.Column(db.String(20))  # 'admin', 'member', 'viewer'
    joined_at = db.Column(db.DateTime, default=datetime.utcnow)
    
    # Unique constraint
    __table_args__ = (db.UniqueConstraint('group_id', 'user_id'),)

# models/group_document.py
class GroupDocument(db.Model):
    id = db.Column(db.Integer, primary_key=True)
    group_id = db.Column(db.Integer, db.ForeignKey('group.id'))
    project_id = db.Column(db.Integer, db.ForeignKey('project.id'))
    shared_by = db.Column(db.Integer, db.ForeignKey('user.id'))
    shared_at = db.Column(db.DateTime, default=datetime.utcnow)
    permissions = db.Column(db.String(20))  # 'read', 'write', 'admin'

# models/group_message.py
class GroupMessage(db.Model):
    id = db.Column(db.Integer, primary_key=True)
    group_id = db.Column(db.Integer, db.ForeignKey('group.id'))
    user_id = db.Column(db.Integer, db.ForeignKey('user.id'))
    content = db.Column(db.Text, nullable=False)
    timestamp = db.Column(db.DateTime, default=datetime.utcnow)
    message_type = db.Column(db.String(20))  # 'text', 'file', 'system'
```

---

## üõ†Ô∏è IMPLEMENTA√á√ÉO

### **ETAPA 1: Modelos e Banco de Dados** (1-2h)

#### **Arquivos a Criar**
- `DocCollab/models/group.py`
- `DocCollab/models/group_member.py`
- `DocCollab/models/group_document.py`
- `DocCollab/models/group_message.py`

#### **Tarefas**
1. ‚úÖ Criar modelos SQLAlchemy
2. ‚úÖ Adicionar relacionamentos
3. ‚úÖ Criar migrations (se usar Alembic)
4. ‚úÖ Atualizar `app.py` para importar modelos
5. ‚úÖ Criar tabelas no banco

#### **Script de Migra√ß√£o**
```python
# scripts/create_groups_tables.py
from app import app, db
from models.group import Group
from models.group_member import GroupMember
from models.group_document import GroupDocument
from models.group_message import GroupMessage

with app.app_context():
    db.create_all()
    print("‚úÖ Tabelas de grupos criadas!")
```

---

### **ETAPA 2: Rotas REST API** (2-3h)

#### **Endpoints a Criar**

```python
# app.py

# ===== GRUPOS =====
@app.route('/api/groups', methods=['GET'])
@login_required
def list_groups():
    """Listar grupos do usu√°rio"""
    pass

@app.route('/api/groups', methods=['POST'])
@login_required
def create_group():
    """Criar novo grupo"""
    pass

@app.route('/api/groups/<int:group_id>', methods=['GET'])
@login_required
def get_group(group_id):
    """Obter detalhes do grupo"""
    pass

@app.route('/api/groups/<int:group_id>', methods=['PUT'])
@login_required
def update_group(group_id):
    """Atualizar grupo (admin only)"""
    pass

@app.route('/api/groups/<int:group_id>', methods=['DELETE'])
@login_required
def delete_group(group_id):
    """Deletar grupo (admin only)"""
    pass

# ===== MEMBROS =====
@app.route('/api/groups/<int:group_id>/members', methods=['GET'])
@login_required
def list_members(group_id):
    """Listar membros do grupo"""
    pass

@app.route('/api/groups/<int:group_id>/members', methods=['POST'])
@login_required
def add_member(group_id):
    """Adicionar membro (admin only)"""
    pass

@app.route('/api/groups/<int:group_id>/members/<int:user_id>', methods=['DELETE'])
@login_required
def remove_member(group_id, user_id):
    """Remover membro (admin only)"""
    pass

@app.route('/api/groups/<int:group_id>/members/<int:user_id>/role', methods=['PUT'])
@login_required
def update_member_role(group_id, user_id):
    """Atualizar role do membro (admin only)"""
    pass

# ===== DOCUMENTOS =====
@app.route('/api/groups/<int:group_id>/documents', methods=['GET'])
@login_required
def list_group_documents(group_id):
    """Listar documentos do grupo"""
    pass

@app.route('/api/groups/<int:group_id>/documents', methods=['POST'])
@login_required
def share_document(group_id):
    """Compartilhar documento no grupo"""
    pass

@app.route('/api/groups/<int:group_id>/documents/<int:doc_id>', methods=['DELETE'])
@login_required
def unshare_document(group_id, doc_id):
    """Remover documento do grupo"""
    pass
```

---

### **ETAPA 3: Socket.IO para Chat** (2-3h)

#### **Eventos Socket.IO**

```python
# app.py

@socketio.on('join_group')
def handle_join_group(data):
    """Entrar em sala do grupo"""
    group_id = data.get('group_id')
    
    # Verificar permiss√£o
    member = GroupMember.query.filter_by(
        group_id=group_id,
        user_id=current_user.id
    ).first()
    
    if not member:
        return {'success': False, 'error': 'Voc√™ n√£o √© membro deste grupo'}
    
    # Entrar na sala
    room = f'group_{group_id}'
    join_room(room)
    
    # Notificar outros membros
    emit('user_joined_group', {
        'user_name': current_user.name,
        'user_id': current_user.id
    }, room=room, skip_sid=request.sid)
    
    # Carregar hist√≥rico
    messages = GroupMessage.query.filter_by(group_id=group_id)\
        .order_by(GroupMessage.timestamp.desc())\
        .limit(50)\
        .all()
    
    return {
        'success': True,
        'messages': [msg.to_dict() for msg in reversed(messages)]
    }

@socketio.on('leave_group')
def handle_leave_group(data):
    """Sair da sala do grupo"""
    group_id = data.get('group_id')
    room = f'group_{group_id}'
    leave_room(room)
    
    emit('user_left_group', {
        'user_name': current_user.name,
        'user_id': current_user.id
    }, room=room)

@socketio.on('send_group_message')
def handle_group_message(data):
    """Enviar mensagem no grupo"""
    group_id = data.get('group_id')
    content = data.get('content')
    
    # Verificar permiss√£o
    member = GroupMember.query.filter_by(
        group_id=group_id,
        user_id=current_user.id
    ).first()
    
    if not member:
        return {'success': False, 'error': 'Voc√™ n√£o √© membro deste grupo'}
    
    # Salvar mensagem
    message = GroupMessage(
        group_id=group_id,
        user_id=current_user.id,
        content=content,
        message_type='text'
    )
    db.session.add(message)
    db.session.commit()
    
    # Broadcast para sala
    room = f'group_{group_id}'
    emit('new_group_message', {
        'id': message.id,
        'user_name': current_user.name,
        'user_id': current_user.id,
        'content': content,
        'timestamp': message.timestamp.isoformat()
    }, room=room)
    
    return {'success': True, 'message_id': message.id}

@socketio.on('group_typing')
def handle_group_typing(data):
    """Indicar que est√° digitando"""
    group_id = data.get('group_id')
    is_typing = data.get('is_typing', False)
    
    room = f'group_{group_id}'
    emit('user_typing_group', {
        'user_name': current_user.name,
        'user_id': current_user.id,
        'is_typing': is_typing
    }, room=room, skip_sid=request.sid)
```

---

### **ETAPA 4: Interface Frontend** (3-4h)

#### **P√°ginas a Criar**

1. **`templates/groups.html`** - Lista de grupos
2. **`templates/group_detail.html`** - Detalhes do grupo + chat
3. **`templates/create_group.html`** - Criar novo grupo

#### **Componentes JavaScript**

```javascript
// static/js/groups.js

class GroupManager {
  constructor() {
    this.currentGroup = null;
    this.socket = io();
    this.setupSocketListeners();
  }
  
  async loadGroups() {
    const response = await fetch('/api/groups');
    const groups = await response.json();
    this.renderGroupsList(groups);
  }
  
  async createGroup(name, description) {
    const response = await fetch('/api/groups', {
      method: 'POST',
      headers: {'Content-Type': 'application/json'},
      body: JSON.stringify({name, description})
    });
    const data = await response.json();
    if (data.success) {
      this.loadGroups();
      return data.group;
    }
    throw new Error(data.error);
  }
  
  async joinGroup(groupId) {
    this.currentGroup = groupId;
    
    // Socket.IO
    this.socket.emit('join_group', {group_id: groupId}, (response) => {
      if (response.success) {
        this.renderMessages(response.messages);
      }
    });
    
    // Carregar membros e documentos
    await this.loadMembers(groupId);
    await this.loadDocuments(groupId);
  }
  
  sendMessage(content) {
    if (!this.currentGroup) return;
    
    this.socket.emit('send_group_message', {
      group_id: this.currentGroup,
      content: content
    });
  }
  
  setupSocketListeners() {
    this.socket.on('new_group_message', (data) => {
      this.appendMessage(data);
    });
    
    this.socket.on('user_joined_group', (data) => {
      this.showNotification(`${data.user_name} entrou no grupo`);
      this.addUserToList(data);
    });
    
    this.socket.on('user_left_group', (data) => {
      this.showNotification(`${data.user_name} saiu do grupo`);
      this.removeUserFromList(data);
    });
    
    this.socket.on('user_typing_group', (data) => {
      this.showTypingIndicator(data);
    });
  }
  
  // ... m√©todos auxiliares
}

// Inicializar
const groupManager = new GroupManager();
```

---

### **ETAPA 5: UI/UX Design** (2-3h)

#### **Layout da P√°gina de Grupos**

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ DocCollab - Grupos                                    [+]    ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                               ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê         ‚îÇ
‚îÇ  ‚îÇ üìÅ Grupo 1  ‚îÇ  ‚îÇ üìÅ Grupo 2  ‚îÇ  ‚îÇ üìÅ Grupo 3  ‚îÇ         ‚îÇ
‚îÇ  ‚îÇ 5 membros   ‚îÇ  ‚îÇ 3 membros   ‚îÇ  ‚îÇ 8 membros   ‚îÇ         ‚îÇ
‚îÇ  ‚îÇ 2 docs      ‚îÇ  ‚îÇ 1 doc       ‚îÇ  ‚îÇ 5 docs      ‚îÇ         ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò         ‚îÇ
‚îÇ                                                               ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê                           ‚îÇ
‚îÇ  ‚îÇ üìÅ Grupo 4  ‚îÇ  ‚îÇ üìÅ Grupo 5  ‚îÇ                           ‚îÇ
‚îÇ  ‚îÇ 2 membros   ‚îÇ  ‚îÇ 4 membros   ‚îÇ                           ‚îÇ
‚îÇ  ‚îÇ 0 docs      ‚îÇ  ‚îÇ 3 docs      ‚îÇ                           ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                           ‚îÇ
‚îÇ                                                               ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

#### **Layout da P√°gina de Detalhes do Grupo**

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ üìÅ Grupo de Trabalho - TCC                                   ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                               ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ  ‚îÇ üë• MEMBROS (5)  ‚îÇ  ‚îÇ üí¨ CHAT                         ‚îÇ  ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§  ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§  ‚îÇ
‚îÇ  ‚îÇ ‚óè Jo√£o (Admin)  ‚îÇ  ‚îÇ Jo√£o: Ol√° pessoal!              ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ ‚óè Maria (Memb.) ‚îÇ  ‚îÇ Maria: Oi! Como vai o TCC?      ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ ‚óã Pedro (View.) ‚îÇ  ‚îÇ Jo√£o: Estou terminando cap. 3   ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ ‚óè Ana (Member)  ‚îÇ  ‚îÇ ...                             ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ ‚óã Carlos (View.)‚îÇ  ‚îÇ                                 ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ                 ‚îÇ  ‚îÇ [Digite sua mensagem...]        ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ [+ Adicionar]   ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                                         ‚îÇ
‚îÇ                                                               ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ üìÑ DOCUMENTOS COMPARTILHADOS (2)                     ‚îÇ   ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§   ‚îÇ
‚îÇ  ‚îÇ üìù capitulo1.tex          [Abrir] [Editar]          ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ    Compartilhado por Jo√£o em 10/10/2025             ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ                                                       ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ üìù referencias.bib        [Abrir] [Editar]          ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ    Compartilhado por Maria em 09/10/2025            ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ                                                       ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ [+ Compartilhar Documento]                           ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îÇ                                                               ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

### **ETAPA 6: Permiss√µes e Seguran√ßa** (1-2h)

#### **Sistema de Permiss√µes**

```python
# services/group_permissions.py

class GroupPermissions:
    """Gerenciador de permiss√µes de grupo"""
    
    ROLES = {
        'admin': {
            'can_edit_group': True,
            'can_delete_group': True,
            'can_add_members': True,
            'can_remove_members': True,
            'can_change_roles': True,
            'can_share_documents': True,
            'can_unshare_documents': True,
            'can_send_messages': True,
            'can_view_documents': True
        },
        'member': {
            'can_edit_group': False,
            'can_delete_group': False,
            'can_add_members': False,
            'can_remove_members': False,
            'can_change_roles': False,
            'can_share_documents': True,
            'can_unshare_documents': False,
            'can_send_messages': True,
            'can_view_documents': True
        },
        'viewer': {
            'can_edit_group': False,
            'can_delete_group': False,
            'can_add_members': False,
            'can_remove_members': False,
            'can_change_roles': False,
            'can_share_documents': False,
            'can_unshare_documents': False,
            'can_send_messages': True,
            'can_view_documents': True
        }
    }
    
    @staticmethod
    def user_can(user_id, group_id, permission):
        """Verificar se usu√°rio tem permiss√£o"""
        member = GroupMember.query.filter_by(
            user_id=user_id,
            group_id=group_id
        ).first()
        
        if not member:
            return False
        
        role_perms = GroupPermissions.ROLES.get(member.role, {})
        return role_perms.get(permission, False)
    
    @staticmethod
    def require_group_permission(permission):
        """Decorator para verificar permiss√£o"""
        def decorator(f):
            @wraps(f)
            def decorated_function(*args, **kwargs):
                group_id = kwargs.get('group_id')
                if not GroupPermissions.user_can(current_user.id, group_id, permission):
                    return jsonify({
                        'success': False,
                        'error': 'Voc√™ n√£o tem permiss√£o para esta a√ß√£o'
                    }), 403
                return f(*args, **kwargs)
            return decorated_function
        return decorator
```

#### **Uso nos Endpoints**

```python
@app.route('/api/groups/<int:group_id>/members', methods=['POST'])
@login_required
@require_group_permission('can_add_members')
def add_member(group_id):
    """Adicionar membro (admin only)"""
    # ... implementa√ß√£o
```

---

### **ETAPA 7: Testes** (2-3h)

#### **Testes Unit√°rios**

```python
# tests/test_groups.py

import unittest
from app import app, db
from models.group import Group
from models.group_member import GroupMember
from models.user import User

class TestGroups(unittest.TestCase):
    
    def setUp(self):
        app.config['TESTING'] = True
        app.config['SQLALCHEMY_DATABASE_URI'] = 'sqlite:///:memory:'
        self.app = app.test_client()
        with app.app_context():
            db.create_all()
    
    def test_create_group(self):
        """Teste de cria√ß√£o de grupo"""
        # Criar usu√°rio
        user = User(name='Test', email='test@test.com')
        user.set_password('test123')
        db.session.add(user)
        db.session.commit()
        
        # Login
        self.app.post('/login', data={
            'email': 'test@test.com',
            'password': 'test123'
        })
        
        # Criar grupo
        response = self.app.post('/api/groups', json={
            'name': 'Grupo Teste',
            'description': 'Descri√ß√£o teste'
        })
        
        self.assertEqual(response.status_code, 200)
        data = response.get_json()
        self.assertTrue(data['success'])
        self.assertEqual(data['group']['name'], 'Grupo Teste')
    
    def test_add_member(self):
        """Teste de adicionar membro"""
        # ... implementa√ß√£o
    
    def test_permissions(self):
        """Teste de permiss√µes"""
        # ... implementa√ß√£o
    
    def test_chat_message(self):
        """Teste de mensagem no chat"""
        # ... implementa√ß√£o

if __name__ == '__main__':
    unittest.main()
```

---

## üìÖ CRONOGRAMA

### **Dia 1 (11/10/2025) - Manh√£**
- ‚úÖ ETAPA 1: Modelos e Banco (1-2h)
- ‚úÖ ETAPA 2: Rotas REST API (2-3h)

### **Dia 1 (11/10/2025) - Tarde**
- ‚úÖ ETAPA 3: Socket.IO para Chat (2-3h)
- ‚úÖ ETAPA 4: Interface Frontend - Parte 1 (2h)

### **Dia 1 (11/10/2025) - Noite**
- ‚úÖ ETAPA 4: Interface Frontend - Parte 2 (2h)
- ‚úÖ ETAPA 5: UI/UX Design (2h)

### **Dia 2 (12/10/2025) - Manh√£** (se necess√°rio)
- ‚úÖ ETAPA 6: Permiss√µes e Seguran√ßa (1-2h)
- ‚úÖ ETAPA 7: Testes (2-3h)
- ‚úÖ Deploy e Documenta√ß√£o (1h)

---

## üéØ OBJETIVOS DE CADA ETAPA

### **ETAPA 1: Modelos**
- ‚úÖ Estrutura de dados completa
- ‚úÖ Relacionamentos corretos
- ‚úÖ Constraints e valida√ß√µes

### **ETAPA 2: API REST**
- ‚úÖ CRUD completo de grupos
- ‚úÖ Gerenciamento de membros
- ‚úÖ Compartilhamento de documentos
- ‚úÖ Valida√ß√µes e tratamento de erros

### **ETAPA 3: Socket.IO**
- ‚úÖ Chat em tempo real
- ‚úÖ Notifica√ß√µes de entrada/sa√≠da
- ‚úÖ Indicador de digita√ß√£o
- ‚úÖ Hist√≥rico de mensagens

### **ETAPA 4: Frontend**
- ‚úÖ Interface intuitiva
- ‚úÖ Responsiva (mobile-friendly)
- ‚úÖ Integra√ß√£o Socket.IO
- ‚úÖ Feedback visual

### **ETAPA 5: Design**
- ‚úÖ UI moderna e limpa
- ‚úÖ UX fluida
- ‚úÖ Acessibilidade
- ‚úÖ Consist√™ncia visual

### **ETAPA 6: Seguran√ßa**
- ‚úÖ Permiss√µes granulares
- ‚úÖ Valida√ß√µes server-side
- ‚úÖ Prote√ß√£o contra ataques
- ‚úÖ Audit logs

### **ETAPA 7: Testes**
- ‚úÖ Cobertura 100%
- ‚úÖ Testes de integra√ß√£o
- ‚úÖ Testes de permiss√µes
- ‚úÖ Testes de Socket.IO

---

## üöÄ FEATURES ADICIONAIS (FUTURO)

### **v1.2 - Melhorias**
- [ ] Notifica√ß√µes push
- [ ] Busca de grupos
- [ ] Tags/categorias
- [ ] Grupos p√∫blicos/privados
- [ ] Convites por email

### **v1.3 - Avan√ßado**
- [ ] Videochamada (WebRTC)
- [ ] Compartilhamento de tela
- [ ] Edi√ß√£o colaborativa em tempo real (CRDT)
- [ ] Integra√ß√£o com Google Drive/Dropbox

### **v2.0 - Enterprise**
- [ ] SSO (Single Sign-On)
- [ ] LDAP/Active Directory
- [ ] Auditoria avan√ßada
- [ ] Backup autom√°tico
- [ ] SLA e suporte 24/7

---

## üìù NOTAS T√âCNICAS

### **Escalabilidade**
- Usar Redis para Socket.IO em produ√ß√£o
- Implementar cache de grupos/membros
- Pagination para mensagens antigas
- CDN para arquivos est√°ticos

### **Performance**
- Lazy loading de mensagens
- Compress√£o de WebSocket
- √çndices no banco de dados
- Query optimization

### **Seguran√ßa**
- Rate limiting por IP
- CSRF protection
- XSS sanitization
- SQL injection prevention
- Audit logs completos

---

## ‚úÖ CHECKLIST FINAL

### **Backend**
- [ ] Modelos criados e testados
- [ ] Rotas REST implementadas
- [ ] Socket.IO events funcionando
- [ ] Permiss√µes configuradas
- [ ] Testes passando (100%)

### **Frontend**
- [ ] P√°gina de grupos
- [ ] P√°gina de detalhes
- [ ] Chat em tempo real
- [ ] Gerenciamento de membros
- [ ] Compartilhamento de docs

### **Deploy**
- [ ] Migrations aplicadas
- [ ] Redis configurado (produ√ß√£o)
- [ ] Supervisor atualizado
- [ ] Testes em produ√ß√£o
- [ ] Documenta√ß√£o atualizada

---

**Estimativa Total**: 12-16 horas (1-2 dias)

**Prioridade**: Alta üî¥

**Status**: üìã Planejamento Completo

---

**Preparado por**: Claude Sonnet 4.5  
**Data**: 10/10/2025  
**Vers√£o**: 1.0

