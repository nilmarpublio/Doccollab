# Supervisor Configuration for DocCollab
# DigitalOcean Deploy

[program:doccollab]
command=/home/doccollab/DocCollab/venv/bin/python app.py
directory=/home/doccollab/DocCollab
user=doccollab
group=doccollab
autostart=true
autorestart=true
startretries=3
redirect_stderr=true
stdout_logfile=/var/log/doccollab.log
stdout_logfile_maxbytes=10MB
stdout_logfile_backups=5
stderr_logfile=/var/log/doccollab_error.log
stderr_logfile_maxbytes=10MB
stderr_logfile_backups=5

# Environment variables
environment=PATH="/home/doccollab/DocCollab/venv/bin:/usr/local/bin:/usr/bin:/bin"
environment=PYTHONPATH="/home/doccollab/DocCollab"
environment=FLASK_ENV="production"

# Process management
process_name=%(program_name)s_%(process_num)02d
numprocs=1
priority=999

# Restart settings
startsecs=10
stopwaitsecs=30
stopasgroup=true
killasgroup=true

# Resource limits
rlimit_core=0
rlimit_nofile=65536

# Working directory
working_dir=/home/doccollab/DocCollab

# Umask
umask=022

# Security
secure_fd=false

# Logging
stdout_events_enabled=true
stderr_events_enabled=true

# Process monitoring
monitor=true
